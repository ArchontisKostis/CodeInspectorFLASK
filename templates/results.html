{% extends "index.html" %}
{% block results_content %}
    <h1 class="text-light">Analysis Results</h1>
    <div class="card">
        <div class="card-body">
            <h5 class="card-title">{{ analysis_results.project_name }}</h5>
            <h6 class="card-subtitle mb-2 text-body-secondary">Total commits: {{ analysis_results.project.get_number_of_commits() }}</h6>
            <a href="{{ repo_url }}" class="card-link">Repository url</a>
        </div>
    </div>

    <hr>

    {% if plot_html %}
        <h3 class="text-light">Hotspot Matrix</h3>
        <div>
            <!-- Placeholder for the Matplotlib chart -->
            <div id="chart">
                {{ plot_html | safe }}
            </div>
        </div>
    {% endif %}

    {% if analysis_results.project.modified_files %}
        <h3 class="text-light">Modified Files</h3>
        <table class="table table-striped table-light">
            <thead>
                <tr>
                  <th scope="col">Filename</th>
                  <th scope="col">NLOC</th>
                  <th scope="col">CC</th>
                  <th scope="col">CHURN</th>
                  <th scope="col">PRIORITY</th>
                </tr>
          </thead>
          <tbody>
{#           #}
            {% for file in  analysis_results.project.modified_files%}
                <tr>
                    <td>{{ file.name }}</td>
                    <td>{{ file.metrics['NLOC'] }}</td>
                    <td>{{ file.metrics['CC'] }}</td>
                    <td>{{ file.metrics['CHURN'] }}</td>
                    <td>
{#                      Display the correct label depending on priority  #}
                        {% if file.priority == 'LOW' %}
                          <span class="badge rounded-pill text-bg-success">LOW</span>
                        {% elif file.priority == 'NORMAL' %}
                          <span class="badge rounded-pill text-bg-primary">NORMAL</span>
                        {% elif file.priority == 'MEDIUM' %}
                          <span class="badge rounded-pill text-bg-warning">MEDIUM</span>
                        {% elif file.priority == 'HIGH' %}
                          <span class="badge rounded-pill text-bg-danger">HIGH</span>
                        {% else %}
                          <span class="badge rounded-pill text-bg-secondary">NOT SET</span>
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
          </tbody>
        </table>
    {% endif %}
{% endblock results_content %}